name: Test connectivity to Lightsail

on:
  push:           # ✅ push 트리거 추가
    branches:
      - main

  workflow_dispatch:  # 👈 기존 수동 실행도 유지

jobs:
  ping-test:
    runs-on: ubuntu-latest
    steps:
      - name: Test SSH
        run: |
          echo "🔁 Trying to connect to ${{ secrets.EC2_HOST }}"
          timeout 10s bash -c "</dev/tcp/${{ secrets.EC2_HOST }}/22" && echo "✅ Port 22 open" || echo "❌ Port 22 closed"
